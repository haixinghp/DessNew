/********************************************************************************************************************
 * @file:      DRV_CLOCK.c
 * @author:    gushengchi
 * @version:   V01.00
 * @date:      2021-08-05
 * @brief:     芯片CLOCK初始化函数
*********************************************************************************************************************/

/*-------------------------------------------------文件包含---------------------------------------------------------*/
#include "DRV_CLK.h"
#include "Public.h"

#include "nrf_drv_clock.h"
#include "nrf_drv_rng.h" 
#include "app_error.h"

#include "nrf_pwr_mgmt.h"

/*-------------------------------------------------宏定义-----------------------------------------------------------*/




/*-------------------------------------------------枚举定义---------------------------------------------------------*/




/*-------------------------------------------------常量定义---------------------------------------------------------*/




/*-------------------------------------------------全局变量定义-----------------------------------------------------*/




/*-------------------------------------------------函数声明---------------------------------------------------------*/




/*-------------------------------------------------函数定义---------------------------------------------------------*/
/*********************************************************************************************************************
* Function Name :  DRV_SysMgmt_Init()
* Description   :  系统工作工作模式
* Para          :  无
* Return        :  void
*********************************************************************************************************************/
void DRV_SysMgmt_Init( void )
{
	ret_code_t err_code;
	err_code = nrf_pwr_mgmt_init();
	APP_ERROR_CHECK(err_code);
	return;
}

/*********************************************************************************************************************
* Function Name :  DRV_SysMgmt_Run()
* Description   :  系统工作工作模式   PowerOFF模式
* Para          :  无
* Return        :  void
*********************************************************************************************************************/
void DRV_SysMgmt_Run( void )
{
	nrf_pwr_mgmt_run();
	return;
}

/*********************************************************************************************************************
* Function Name :  DRV_HFClock_Request()
* Description   :  唤醒外部高频
* Para          :  无
* Return        :  void
*********************************************************************************************************************/
void DRV_HFClock_Request( void )
{
	nrf_drv_clock_hfclk_request(NULL);              //唤醒开启外部高频
	uint16_t time = 0;
	while( nrf_drv_clock_hfclk_is_running() == 0 )  //等待起振
	{
		PUBLIC_Delayms(1);
		time++;
		if( time > 1000 )  //超时退出
		{
			break;
		}
	}
	return;
}

/*********************************************************************************************************************
* Function Name :  DRV_HFClock_Release()
* Description   :  释放外部高频
* Para          :  无
* Return        :  void
*********************************************************************************************************************/
void DRV_HFClock_Release( void )
{
	nrf_drv_clock_hfclk_release();
	return;
}














/*-------------------------------------------------THE FILE END-----------------------------------------------------*/

